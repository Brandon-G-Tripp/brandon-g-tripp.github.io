{"version":3,"sources":["app/feats/featsList.controller.js"],"names":[],"mappings":"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","file":"featsList.controller.js","sourcesContent":["'use strict';\n\nimport angular from 'angular';\nimport 'lodash';\nimport feats from './feats.json!'\nimport featPrereqOutput from './featPrereqOutput';\n\nconsole.log('TODO import and pin it here')\n\nclass FeatsListCtrl {\n\n  // called once when the class is instantiated\n  constructor ($scope, $sce, $state, $mdMedia, Config, Link) {\n    this.$scope = $scope;\n    this.$scope.$mdMedia = $mdMedia;\n    this.Config = Config;\n    this.Link = Link;\n    this.featPrereqOutput = featPrereqOutput;\n\n    this.powers = [];\n    this.powers = feats;\n    this.attributes = [\n            'All',\n            'Alteration',\n            'Creation',\n            'Fortitude',\n            'Energy',\n            'Entropy',\n            'Movement',\n            'Influence',\n            'Prescience',\n            'Protection',\n          ];\n    this.selectedPowers = [];\n    this.selectedAttributes = ['All'];\n    this.searchQuery = '';\n    this.attackAttrSearchText = '';\n    this.powerLevelValue = 1;\n    // this.powerComparator = 'or Greater';\n    this.powerComparator = 'gte';\n  }\n\n  // public class methods\n  updateSearchTextModel (val) {\n    this.attackAttrSearchText = val;\n  }\n\n  attackAttrSearchFilter () {\n    // return all the options if the user hasn't selected a filter\n    return (item) => {\n      return true;\n\n      // @TODO - Make this work!\n      if ( this.attackAttrSearchText === '' ){\n        return true;\n      } else {\n        if ( !Array.isArray(item.prerequisite) ) return false;\n        const prereqsAsString = item.prerequisite.join().toLowerCase();\n        let matchedSelectWithPrereq = []\n        this.selectedAttributes.forEach( attr => {\n          console.log('prereqsAsString.split(i).length > 1',prereqsAsString.split(i).length > 1)\n          if ( prereqsAsString.split(attr).length > 1 ) {\n            matchedSelectWithPrereq.push(attr)\n          }\n        });\n        return matchedSelectWithPrereq.length > 0;\n      }\n    }.bind(this);\n  }\n\n  textSearchFilter () {\n    // if `searchQuery` is empty, we want to show all list items\n    return (thisPower) => {\n      // debugger;\n      var item = thisPower;\n      if ( this.searchQuery === '' && _.includes( this.selectedAttributes, 'All' ) ) {\n        return true;\n      }\n      var regex = new RegExp(this.searchQuery, 'gi');\n      var show = false; // initially we assume that we won't show a given result\n      var inAttackFilter = true;\n      // now we look for matches in the following object properties\n      show = item.name.match(regex) || item.description.match(regex) || item.effect.match(regex);\n      // if the selectedAttributes array is longer than 0, we need to show\n      // only results that match one of the selected properties\n      if ( this.selectedAttributes.length > 0 ) {\n        var inAttackFilter = false;\n        if ( this.selectedAttributes.indexOf('All') !== -1 ) {\n          inAttackFilter = true;\n        } else {\n          var searchAttrs = angular.copy( this.selectedAttributes );\n          var inAttackFilter = _.intersection( item.attribute, searchAttrs ).length > 0;\n          // console.log( inAttackFilter );\n        }\n      }\n      // return the result (either `true` or `false`)\n      return show && inAttackFilter;\n    }\n  }\n\n  powerLevelFilter () {\n    return (thisPower) => {\n      var item = thisPower;\n      // const powerAbove = ( this.powerComparator === 'or Greater' );\n      // const powerAbove = ( this.powerComparator === 'or Greater' );\n      // if ( this.powerComparator === 'greater' ) {\n\n      // }\n      var include = false;\n      for (var i = 0; i <= item.cost.length; i++) {\n        switch (this.powerComparator) {\n          case 'gte':\n            if ( item.cost[i] >= parseInt( this.powerLevelValue ) ) {\n              include = true;\n            }\n            break;\n          case 'eq':\n            if ( item.cost[i] === parseInt( this.powerLevelValue ) ) {\n              include = true;\n            }\n            break;\n          case 'lte':\n            if ( item.cost[i] <= parseInt( this.powerLevelValue ) ) {\n              include = true;\n            }\n            break;\n        }\n\n        // if ( powerAbove && item.cost[i] > this.powerLevelValue ) {\n        //   include = true;\n        //   break;\n        // } else if ( !powerAbove && item.cost[i] <= this.powerLevelValue ) {\n        //   include = true;\n        //   break;\n        // }\n      };\n      return include;\n\n    }\n  }\n\n  getCost (costs) {\n    let output = '';\n    if (costs.length > 1) {\n      costs.splice(costs.length - 1, 1, ' or ' + costs.length)\n      costs.forEach( (cost, i) => {\n        output += `${ cost }${ (i !== costs.length - 1) ? ', ' : ' points' }`;\n      });\n      return output;\n    } else {\n      return `${ costs[0] } ${ (costs[0] > 1) ? 'points' : 'point' }`;\n    }\n  }\n}\n\nexport default FeatsListCtrl;\n"]}